---
title: "<span style='color: orange ;font-family: Times New Roman, serif; font-size: 28pt; font-weight: bold; text-align: center;'>Cuadro depresivo vs: alcoholismo, salario medio y horas de luz</span>"
author: "Henar Ronda, Yasmina Álamo y Raúl Ortega"
date: "`r format (Sys.time(),'%d %B %Y')`"
output: 
  html_document:
    toc: TRUE
    css: stt.css
  pdf_document:
      keep_text: TRUE
---
# __Introducción__

  El estudio que nos ocupa se trata de un análisis de la Salud Mental, más concretamente del nivel de cuadro depresivo mayor total por Comunidades Autónomas para ambos sexos. Para ello hemos querido estudiar tres posibles causas que podrían relacionarse como causa-efecto: el consumo de alcohol, el salario promedio y las horas de luz al año que disfrutan los habitantes de las respectivas comunidades. 
  Hemos estructurado el informe en tres partes principales donde compararemos la depresión con cada uno de estos factores, y finalmente una comparación global donde extraeremos las conclusiones.
  Cabe destacar que el estudio ha sido realizado a nivel de España.


## __Depresión__


### _Datos sobre la depresión_
  Para el análisis trabajaremos sobre el índice que indica el nivel de depresión
A continuación se mostrarán los datos del cuadro depresivo mayor por Comunidad Autónoma. 
Importamos la biblioteca correspondiente para poder leer el archivo csv: 

```{r, eval=TRUE, echo=TRUE}
library(readxl)
library(DT)
```
Importación de los datos a tratar: 

```{r, eval=TRUE, echo=TRUE}
depresion <- read.csv("INPUT/DATA/DEPRESION.csv", 
    sep = ";", fileEncoding = "Latin1", header = TRUE, stringsAsFactors = FALSE)
datatable(depresion)
```
```{r, eval=TRUE, echo=TRUE}
depresion_cambiado <- read.csv("INPUT/DATA/depresion_cambiado.csv", 
    sep = ";", fileEncoding = "Latin1", header = TRUE, stringsAsFactors = FALSE)
depresion_cambiado$Comunidades.y.Ciudades.Autónomas[depresion_cambiado$Comunidades.y.Ciudades.Autónomas == ""] <- "Total"
datatable(depresion)
```

## __Alcoholismo__

### _Datos sobre el alcoholismo:_
En primer lugar tenemos un conjunto de datos que estudian la cantidad de alcohol que se consume por Comunidad Autónoma. La medida total se encuentra en gramos de alcohol puro diario por personas que beben más de una vez al mes donde, por ejemplo, una cerveza con alcohol equivale a 10 g.

No es necesario importar la biblioteca que nos permitirá leer el archivo csv ya que ha sido importada anteriormente.

Importamos los datos mediante el siguiente código:

```{r, eval=TRUE, echo=TRUE}
alcohol <- read.csv("INPUT/DATA/ALCOHOL.csv", 
    sep = ";", fileEncoding = "Latin1", header = TRUE, stringsAsFactors = FALSE)
alcohol$Comunidades.y.Ciudades.Autónomas[alcohol$Comunidades.y.Ciudades.Autónomas == ""] <- "Total"
datatable(alcohol)
```

### _Comparación con la depresión_
  Para poder comparar los datos y sacar conclusiones, hemos de cruzar las tablas y obtener una gráfica que nos permita observar la relación existente entre ambos factores. Para ello realizaremos el siguiente código:
  
```{r, eval=TRUE, echo=TRUE}
library(ggplot2)
comparacion <- merge(depresion_cambiado, alcohol, by = "Comunidades.y.Ciudades.Autónomas")
names(comparacion)
tabla_final<-comparacion[ ,c("Comunidades.y.Ciudades.Autónomas", "Prevalencia.depresión", "Total.y")]
tabla_final


ggplot(tabla_final, aes(x=Comunidades.y.Ciudades.Autónomas, y=Prevalencia.depresión)) +
  geom_point() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

```{r, eval=TRUE, echo=TRUE}
library(ggplot2)
datos <- rbind(depresion_cambiado, alcohol)
ggplot(datos, aes(x=Comunidades.y.Ciudades.Autónomas, y=Número.medio)) + 
  geom_point() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```
  

### _Análisis breve_

## __Salario__

### _Datos sobre el salario medio_
  Este factor que analizaremos tiene en cuenta el salario medio anual por individuo dependiendo de la Comunidad Autónoma en la que se encuentre. 

  Para poder trabajar datos en formato __JSON__ tenemos que importar primero esta biblioteca:
```{r,eval=TRUE, echo=TRUE}
library(jsonlite)
library(knitr)
```
  Ruta al archivo JSON
  
```{r,eval=TRUE, echo=TRUE}
ruta_archivo<-"INPUT/DATA/salarios.json"
```
```{r,eval=TRUE, echo=TRUE}
salarios<-fromJSON(ruta_archivo)
kable(salarios)
```


```{r,eval=TRUE, echo=TRUE}
salarios$Data[[1]]$Valor
salarios$MetaData[[1]]
salarios

```

### _Comparación con la depresión_

### _Análisis breve_

## __Horas de luz__

### _Datos sobre horas de luz_
En este caso estudiaremos el número de horas de luz que disfruta cada provincia en España al año. Los datos los tenemos agrupados por provincias, por lo que hemos de cambiarlo a Comunidades Autónomas.

### _Comparación con la depresión_

### _Análisis breve_

# __Conclusión__
